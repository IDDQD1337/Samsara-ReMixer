// General Rom Mohc, the final boss from Dark Forces - technically also the only Dark Trooper not to be a robot, afaik.
ACTOR phase3_DF : enemy_base
{
	Health		 5000
	Radius		 32
	Height		 64
	Speed		 12
	FloatSpeed   12
	Mass		 4000
	Scale		 0.75
	Damagefactor "Falling", 0
	SeeSound	 "enemies/phase3/see"
	PainSound	 "enemies/phase3/pain"
	DeathSound	 "enemies/phase3/death"
	obituary 	 "%o was defeated by General Rom Mohc from aboard the Dark Trooper Phase 3."
	Tag 		 "Phase III"	
	+BOSS
	+DROPOFF
	+NOBLOCKMONST
	-NODROPOFF
	+BOSSDEATH	
	+NOBLOOD
	+DONTRIP	
	+DONTHARMCLASS
	+DONTHARMSPECIES
    DamageFactor "Mace", 1.4
	DamageFactor "CorvusHellstaffTomed", 0.1
    DamageFactor "CorvusCrossbow", 1.1	
    DamageFactor "DragonClaw", 1.5
	DamageFactor "MarathonShotgun", 0.8
	DamageFactor "MarathonPlasmaFire", 0.88
	DamageFactor "MarathonFusion", 2.0	
    DamageFactor "WMCNade", 0.8
    DamageFactor "BJSpear", 0.5	
	DamageFactor "DCannonProj", 0.8	
	DamageFactor "Tesla", 0.6
	DamageFactor "Shock", 0.3
	DamageFactor "LifeLeech", 0.1		
	DamageFactor "CalebFire", 0.7
    DamageFactor "CalebBullet", 0.6	
	DamageFactor "Vodoo", 0.1
	DamageFactor "DisruptorWall", 0.3
	DamageFactor "EradNova", 0.3
    DamageFactor "EradGreenFire", 0.1	
    DamageFactor "EradCoopGreenFire", 0.1	
	DamageFactor "RottFire", 0.4
	DamageFactor "HLLaser", 0.5
	DamageFactor "WTRangedFire", 0.7
	DamageFactor "Nuke", 0.3
	DamageFactor "SWNuke", 0.2
	DamageFactor "SWNukeCoop", 0.2	
	DamageFactor "SWFlame", 0.1
	DamageFactor "SWFlameCoop", 0.1	
	DamageFactor "SWFlame2", 0.1
	DamageFactor "SWFlame2Coop", 0.1
	DamageFactor "SWFlame3", 0.6
    DamageFactor "RMR-BigPlasma", 0.3
	DamageFactor "CMDMGSHIT", 0.7
	DamageFactor "Disintegrate", 0.4
	DamageFactor "RottBullet", 0.6
	DamageFactor "C7Disintegrate", 0.5	
	PainChance "ShrinkerDMG", 0
	States
	{
		Spawn:
			PHA3 A 0
			PHA3 A 1 A_JumpIfInventory("AlreadySpawned",1,"Spawn2")
			PHA3 A 1 ACS_ExecuteAlways(668,0,1,0)
			PHA3 A 0 A_GiveInventory("AlreadySpawned",1)
		Spawn2:
			TNT1 A 0 A_Jump(256,"SpawnLoop")
			TNT1 A 0 A_PlaySound("phase3/seeZ",CHAN_VOICE,1.0,0,ATTN_NONE)
		SpawnLoop:	
			PHA3 A 5 A_Look
			Loop
		Idle:
			PHA3 A 5 A_Look
			Loop			
		See:
			TNT1 A 0 A_JumpIfInventory("SawPlayer", 1, "See2")
			TNT1 A 0 A_GiveInventory("SawPlayer", 1)		
			TNT1 A 0 A_GiveToTarget("EleenaBossSightTaunt")
			TNT1 A 0 A_GiveToTarget("LoWangBossSightTaunt")
			TNT1 A 0 A_GiveToTarget("LeonardBossSightTaunt")					
			TNT1 A 0 A_GiveToTarget("DukeBossSightTaunt")
			TNT1 A 0 A_GiveToTarget("CalebBossSightTaunt")
			TNT1 A 0 A_GiveToTarget("HLBossSightMusicQueue")
		See2:	
			PHA3 A 0 A_ChangeFlag("NOGRAVITY",0)
			PHA3 U 0 A_ChangeFlag("FLOAT",0)			
			TNT1 A 0 A_Jump(10,"JetPack")
			PHA3 ABCDE 4 A_Chase
			Goto See+2
		JetPack:
			TNT1 A 0 A_ChangeFlag(NOPAIN,1)
		    TNT1 A 0 A_ChangeFlag("FLOAT", 1)
            TNT1 A 0 A_ChangeFlag("NOGRAVITY", 1)		
			TNT1 A 0 ThrustThingZ(0,12,0,0)			
			PHA3 OP 3 A_Chase("","")
			TNT1 A 0 A_ChangeFlag(NOPAIN,0)			
		Flying:
			PHA3 Q 1 A_Chase("","MFlying")
		    TNT1 A 0 A_JumpIf(z - floorz < 24, "Landing")			
			Loop
		Landing:
		    TNT1 A 0 A_JumpIf(z - floorz > 25, "Flying")					
			PHA3 R 1 A_Chase("","MLanding")
			TNT1 A 0 A_JumpIf(z <= floorz+4,"Land")
			Loop
		Land:
			TNT1 A 0 A_ChangeFlag(NOPAIN,1)		
			PHA3 V 0 A_ChangeFlag("NOGRAVITY",0)
			PHA3 U 0 A_ChangeFlag("FLOAT",0)						
			PHA3 RPO 1 A_Chase("","")
			TNT1 A 0 A_ChangeFlag(NOPAIN,0)			
			Goto See
		Missile:
			PHA3 F 0 A_Jump(30,"MRocket")
			PHA3 AA 4 A_FaceTarget
			PHA3 E 7 BRIGHT A_CustomMissile("plasma_shot_2_3",43)
			PHA3 G 0 A_PlaySound("katarn/assshot",CHAN_AUTO,1.0,0,0.45)
			PHA3 C 1 A_FaceTarget 
			TNT1 A 0 A_Jump(140,"See")
			TNT1 A 0 A_CPosRefire
			Goto Missile+2
		MFlying:
			PHA3 U 0 A_Jump(40,"RocketFlying")
			PHA3 QQ 4 A_FaceTarget
			PHA3 Q 7 BRIGHT A_CustomMissile("plasma_shot_2_3",43)
			PHA3 U 0 A_PlaySound("katarn/assshot",CHAN_AUTO,1.0,0,0.45)
			PHA3 Q 1 A_FaceTarget
			TNT1 A 0 A_Jump(140,"Flying")
			TNT1 A 0 A_CPosRefire
			Goto MFlying+2
		MLanding:
			PHA3 V 0 A_Jump(30,"RocketLanding")
			PHA3 RR 4 A_FaceTarget
			PHA3 R 7 BRIGHT A_CustomMissile("plasma_shot_2_3",43)
			PHA3 R 0 A_PlaySound("katarn/assshot",CHAN_AUTO,1.0,0,0.45)
			PHA3 R 1 A_FaceTarget
			TNT1 A 0 A_Jump(140,"Landing")
			TNT1 A 0 A_CPosRefire
			Goto MLanding+2
		MRocket:
			PHA3 KKLLMM 4 A_FaceTarget
			PHA3 S 0 BRIGHT A_CustomMissile("Phase3Missile",46,0,-12,32,random(-1,1))
			PHA3 S 0 BRIGHT A_CustomMissile("Phase3Missile",44,0,-8,32,random(-1,1))
			PHA3 S 0 BRIGHT A_CustomMissile("Phase3Missile",42,0,-4,32,random(-1,1))
			PHA3 S 0 BRIGHT A_CustomMissile("Phase3Missile",40,0,0,32,random(-1,1))
			PHA3 S 0 BRIGHT A_CustomMissile("Phase3Missile",42,0,4,32,random(-1,1))
			PHA3 S 0 BRIGHT A_CustomMissile("Phase3Missile",44,0,8,32,random(-1,1))
			PHA3 N 8 BRIGHT A_CustomMissile("Phase3Missile",46,0,12,32,random(-1,1))
			PHA3 S 0 A_PlaySound("katarn/asssho2",CHAN_AUTO,1.0,0,0.45)
			PHA3 MLK 8 A_FaceTarget
			Goto See
		RocketFlying:
			PHA3 KKLLMM 4 A_FaceTarget
			PHA3 S 0 BRIGHT A_CustomMissile("Phase3Missile",46,0,-12,32,random(-1,1))
			PHA3 S 0 BRIGHT A_CustomMissile("Phase3Missile",44,0,-8,32,random(-1,1))
			PHA3 S 0 BRIGHT A_CustomMissile("Phase3Missile",42,0,-4,32,random(-1,1))
			PHA3 S 0 BRIGHT A_CustomMissile("Phase3Missile",40,0,0,32,random(-1,1))
			PHA3 S 0 BRIGHT A_CustomMissile("Phase3Missile",42,0,4,32,random(-1,1))
			PHA3 S 0 BRIGHT A_CustomMissile("Phase3Missile",44,0,8,32,random(-1,1))
			PHA3 N 8 BRIGHT A_CustomMissile("Phase3Missile",46,0,12,32,random(-1,1))
			PHA3 S 0 A_PlaySound("katarn/asssho2",CHAN_AUTO,1.0,0,0.45)
			PHA3 MLK 8 A_FaceTarget
			Goto Flying
		RocketLanding:
			PHA3 KKLLMM 4 A_FaceTarget
			PHA3 S 0 BRIGHT A_CustomMissile("Phase3Missile",46,0,-12,32,random(-1,1))
			PHA3 S 0 BRIGHT A_CustomMissile("Phase3Missile",44,0,-8,32,random(-1,1))
			PHA3 S 0 BRIGHT A_CustomMissile("Phase3Missile",42,0,-4,32,random(-1,1))
			PHA3 S 0 BRIGHT A_CustomMissile("Phase3Missile",40,0,0,32,random(-1,1))
			PHA3 S 0 BRIGHT A_CustomMissile("Phase3Missile",42,0,4,32,random(-1,1))
			PHA3 S 0 BRIGHT A_CustomMissile("Phase3Missile",44,0,8,32,random(-1,1))
			PHA3 N 8 BRIGHT A_CustomMissile("Phase3Missile",46,0,12,32,random(-1,1))
			PHA3 S 0 A_PlaySound("katarn/asssho2",CHAN_AUTO,1.0,0,0.45)
			PHA3 MLK 8 A_FaceTarget
			Goto Landing
		Pain:
			PHA3 F 3
			PHA3 G 3 A_Pain
			Goto See
		Death:
		XDeath:
	        TNT1 A 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)			
			TNT1 A 0 A_Scream
			PHA3 H 10 A_Gravity
			PHA3 I 10 A_Noblocking
			PHA3 J 10 
			PHA3 J -1 A_KillMaster
			Stop
		Death.DukeIce:
			"####" "#" 0 A_GiveToTarget("DukeBossKillTaunt",1)
		Ice:
		Death.HexenIce:
		Death.WTMeleeIce:
		Death.WTRangedIce:
		Death.Ice:
			"####" "#" 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)
			"####" "#" 0 A_NoBlocking
			"####" "#" 0 A_GenericFreezeDeath
			"####" "#" 0 A_UnsetShootable
			"####" "#" 140 A_UnsetSolid
			"####" "#" 0 A_PlaySoundEx("freeze/break","soundslot6",0,0)
			"####" "##########################################################################################" 0 A_SpawnItemEx("IceChunk2",random(-1,1),random(-1,1),random(16,96),random(-2,2),random(-2,2),random(5,15))
			"####" "#" 0 A_IceGuyDie
			"####" "#" 1 A_IceGuyDie
			TNT1 A 5 A_KillMaster
			stop			
		Death.Vodoo:
		Death.VoodooPuff:
		Death.DynamiteCoop:
		Death.Dynamite:
		Death.LifeLeech:
		Death.CalebNapalm:
		Death.Shock:	  
		Death.Vodoo:
		Death.Tesla:
		Death.CalebFire:	
		Death.CalebBullet:	
			TNT1 A 0 A_Jump(218, "Death")
			TNT1 A 0 A_GiveToTarget("CalebDMTaunt3", 1)
			Goto Death
		Death.EradExplosive:
		Death.EradNova:
		Death.EradShock:
		Death.EradExplosive2:	
		Death.EradDisc:
		Death.EradPiercingDart:
		Death.EradGreenFire:
		Death.EradCoopGreenFire:
			TNT1 A 0 A_Jump(218, "Death")
			TNT1 A 0 A_GiveToTarget("EleenaDMTaunt2", 1)
			Goto Death
		Death.PSRAPower:
		Death.PSRAPowerCoop:
		Death.PSExplosive:
		Death.PSExplosiveCoop:
		Death.PSBullet:
		Death.PSFire:	
			TNT1 A 0 A_Jump(218, "Death")
			TNT1 A 0 A_GiveToTarget("JonDMTaunt1", 1)
			Goto Death
		Death.LeonardDamage2:
		Death.LeonardDamage3:
		Death.LeonardDamage0:
		Death.LeonardDamage1:	
			TNT1 A 0 A_Jump(218, "Death")
			TNT1 A 0 A_GiveToTarget("LeonardDMTaunt2", 1)
			Goto Death
		Death.SWFist:
		Death.SWKatana:
		Death.SWShuriken:
		Death.SWSticky:
		Death.SWStickyCoop:	
		Death.SWGrenade:
		Death.SWNuke:
		Death.SWRocket:
		Death.SWRailgun:
		Death.SWRailgunCoop:
		Death.SWNukeCoop:
		Death.SWFlame:
		Death.SWFlame2:
		Death.SWFlame2Coop:
		Death.SWFlame3:	
		Death.SWBullet:	  
			TNT1 A 0 A_Jump(218, "Death")
			TNT1 A 0 A_GiveToTarget("LoWangDMTaunt2", 1)
			goto Death
		Death.DukeExplosive:
		Death.DukeDamage:
		Death.DukePistol:
			TNT1 A 0 A_Jump(218,"Death")
			TNT1 A 0 A_GiveToTarget("DukeBossKillTaunt",1)
			goto Death
		Death.MightyBoot:
			TNT1 A 0 A_PlaySoundEx("duke/kickhit","body",0,0)
			TNT1 A 0 A_Jump(64,"Death")
			TNT1 A 0 A_GiveToTarget("DukeBossKillTaunt",1)
			goto Death
		Death.RottDisintegrate:
			"####" "#" 0 A_ChangeFlag("SOLID", 0)
			"####" "#" 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)
			"####" "#" 0 A_Scream
			"####" "#" 0 A_NoBlocking	
			"####" "#" 0 ACS_ExecuteAlways(2530,0,1)
			"####" "#" 0 A_Stop
			"####" "#" 0 A_ChangeFlag("SHOOTABLE",FALSE)
			"####" "#" 0 A_ChangeFlag("NOGRAVITY",TRUE)
			"####" "#" 0 A_ChangeFlag("FLOORCLIP",TRUE)
			"####" "#" 0 A_SpawnItem("RGodModeDeathHuge")
			"####" "#" 3 A_SetTranslucent(0.9,0)
			"####" "#" 0 ACS_ExecuteAlways(2530,0,1)
			"####" "#" 3 A_SetTranslucent(0.8,0)
			"####" "#" 0 ACS_ExecuteAlways(2530,0,1)
			"####" "#" 3 A_SetTranslucent(0.7,0)
			"####" "#" 0 ACS_ExecuteAlways(2530,0,1)
			"####" "#" 3 A_SetTranslucent(0.6,0)
			"####" "#" 0 ACS_ExecuteAlways(2530,0,1)
			"####" "#" 3 A_SetTranslucent(0.5,0)
			"####" "#" 0 ACS_ExecuteAlways(2530,0,1)
			"####" "#" 2 A_SetTranslucent(0.4,0)
			"####" "#" 0 ACS_ExecuteAlways(2530,0,1)
			"####" "#" 2 A_SetTranslucent(0.3,0)
			"####" "#" 0 ACS_ExecuteAlways(2530,0,1)
			"####" "#" 2 A_SetTranslucent(0.2,0)
			"####" "#" 0 ACS_ExecuteAlways(2530,0,1)
			"####" "#" 2 A_SetTranslucent(0.1,0)
			TNT1 A 5 A_KillMaster
			stop
		Disintegrate:
			"####" "#" 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)
			"####" "#" 0 A_NoBlocking
			"####" "#" 0 A_ChangeFlag("DONTGIB",1)
			"####" "#" 0 ACS_ExecuteAlways(2530,0,1)
			"####" "#" 0 A_Scream
			"####" "#" 0 A_ChangeFlag("SOLID",FALSE)
			"####" "#" 0 A_ChangeFlag("SHOOTABLE",FALSE)
			"####" "#" 0 A_ChangeFlag("NOGRAVITY",TRUE)
			"####" "#" 0 A_ChangeFlag("FLOORCLIP",TRUE)
			"####" "#" 0 A_Stop
			"####" "#" 3 A_SpawnItem("DisintEffectHuge",0,10)
			"####" "#" 3 A_SetTranslucent(0.9,0)
			"####" "#" 0 ACS_ExecuteAlways(2530,0,1)
			"####" "#" 3 A_SetTranslucent(0.8,0)
			"####" "#" 0 ACS_ExecuteAlways(2530,0,1)
			"####" "#" 3 A_SetTranslucent(0.7,0)
			"####" "#" 0 ACS_ExecuteAlways(2530,0,1)
			"####" "#" 3 A_SetTranslucent(0.6,0)
			"####" "#" 0 ACS_ExecuteAlways(2530,0,1)
			"####" "#" 3 A_SetTranslucent(0.5,0)
			"####" "#" 0 ACS_ExecuteAlways(2530,0,1)
			"####" "#" 2 A_SetTranslucent(0.4,0)
			"####" "#" 0 ACS_ExecuteAlways(2530,0,1)
			"####" "#" 2 A_SetTranslucent(0.3,0)
			"####" "#" 0 ACS_ExecuteAlways(2530,0,1)
			"####" "#" 2 A_SetTranslucent(0.2,0)
			"####" "#" 0 ACS_ExecuteAlways(2530,0,1)
			"####" "#" 2 A_SetTranslucent(0.1,0)
			TNT1 A 5 A_KillMaster
			stop
		Death.Nuke:
			"####" "#" 0 A_ChangeFlag("SOLID", 0)
			"####" "#" 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)
			"####" "#" 0 A_Scream
			"####" "#" 0 A_NoBlocking		
			"####" "#" 0 A_SpawnItem("WTNukeDeathHuge")
			"####" "#################" 3 A_Fadeout(0.05)
			TNT1 A 5 A_KillMaster
			stop
		Death.ZorchPistol:
		Death.Zorch:
		Death.ZorchKamikaze:
		Death.PhasingZorch:
		Death.ZorchSpectral:
			"####" "#" 0 ACS_NamedExecuteAlways("Samsara_KillCount", 0, 0)
			"####" "#" 0 A_Stop
			"####" "#" 0 A_ChangeFlag("DONTGIB",1)
			"####" "#" 0 A_PlaySoundEx("chex/zorchhuge","soundslot5",0,0)
			"####" "#" 3 A_SpawnItem("ZorchEffectHuge")
			"####" "#" 0 A_GiveInventory("EnemyZorched",1)
			"####" "#" 3 A_SetTranslucent(0.9,0)
			"####" "#" 0 A_Scream
			"####" "#" 3 A_SetTranslucent(0.8,0)
			"####" "#" 0 A_NoBlocking
			"####" "#" 3 A_SetTranslucent(0.7,0)
			"####" "#" 3 A_SetTranslucent(0.6,0)
			"####" "#" 3 A_SetTranslucent(0.5,0)
			"####" "#" 3 A_SetTranslucent(0.4,0)
			"####" "#" 3 A_SetTranslucent(0.3,0)
			"####" "#" 3 A_SetTranslucent(0.2,0)
			"####" "#" 3 A_SetTranslucent(0.1,0) 
			TNT1 A 1 A_SetTranslucent(1,0)
			TNT1 A -1 A_KillMaster
			stop			
	}
}

actor Phase3Missile : assault_missile
{
  Speed   18
  Damage  (10)
  Species "Enemies"
  DONTHURTSHOOTER
  +DONTHARMCLASS
  -FORCERADIUSDMG
  States
  {
    Spawn:
      TNT1 A 0 
      PMIS A 0 A_PlaySound("katarn/missfly",CHAN_BODY,1.0,1,ATTN_NORM)
	SpawnLoop: 
      PHA3 UT 3 BRIGHT
      Loop 
    Death:
      TNT1 A 1 A_StopSound(CHAN_BODY)
      TNT1 A 0 A_SpawnItemEx("assmissile_explosion")
      TNT1 A 0 A_PlaySound("katarn/exmiss",5,1.0,0,ATTN_NORM)
      TNT1 A 5 A_Explode(random(10,65),128)
      Stop
  }
}

Actor plasma_shot_2_3 : plasma_shot { Speed 40 Damage (Random(25,(40-Random(5,8)))-Random(15,0)) }