Actor MMRandomizer_Wraith
{
	HitObituary "%o was slashed by a Wraith."
	Health 150
	Radius 22
	Height 56
	Mass 200
	Speed 12
	PainChance 64
	MeleeDamage 4
	SeeSound "VDR/D3Wraith/Sight"
	PainSound "VDR/D3Wraith/Pain"
	DeathSound "VDR/D3Wraith/Death"
	ActiveSound "VDR/D3Wraith/Active" //Wraith doesn't play any active sounds, in Doom 3, but here they are anyway
	MeleeSound "Imp/Melee"
	Monster
	+FLOORCLIP
	States
	{
		Spawn:
			VD49 A 1
			VD49 A 0 A_JumpIf(Args[0] > 0, "Spawn2")
			VD49 A 0 A_JumpIfInventory("MMRandomizer_WraithTeleporting", 1, "StopTeleport")
			VD49 A 1 A_Look
			Goto Spawn+1
		Spawn2:
			VD49 A 0 A_JumpIfInventory("MMRandomizer_WraithTeleporting", 1, "StopTeleport")
			VD49 A 1 A_LookEx(8, 0, 0, 0, 0, "Teleport")
			Loop
		StopTeleport:
			VD49 A 0 A_SpawnItem("TeleportFog")
			VD49 A 0 A_ChangeFlag("Invulnerable", 0)
			VD49 A 0 A_SetShootable
			VD49 A 0 A_ChangeFlag("NonShootable", 0)
			VD49 A 0 A_ChangeFlag("Shootable", 1)
			VD49 A 0 A_ChangeFlag("NoTeleport", 0)
			VD49 A 0 A_ChangeFlag("NoRadiusDMG", 0)
			VD49 A 0 A_TakeInventory("MMRandomizer_WraithTeleporting", 1)
			Goto Spawn
		See:
			VD49 B 2 A_Chase("", "", 0)
			VD49 BBCCCDDDEEE 2 A_Chase
			VD49 B 0 A_JumpIf(Args[1] > 0, 1)
			Goto See+1
			VD49 B 0 A_Jump(16, "Missile")
			Goto See+1
		Melee:
			VD49 A 0 A_JumpIfInventory("MMRandomizer_WraithTeleporting", 1, 5)
			VD49 A 6 A_FaceTarget
			VD49 F 5 A_FaceTarget
			VD49 G 0 A_PlayWeaponSound("VDR/D3Wraith/Attack")
			VD49 G 8 A_MeleeAttack
			goto see
			VD49 A 0 A_SpawnItem("TeleportFog")
			VD49 A 0 A_ChangeFlag("Invulnerable", 0)
			VD49 A 0 A_SetShootable
			VD49 A 0 A_ChangeFlag("NonShootable", 0)
			VD49 A 0 A_ChangeFlag("Shootable", 1)
			VD49 A 0 A_ChangeFlag("NoTeleport", 0)
			VD49 A 0 A_ChangeFlag("NoRadiusDMG", 0)
			VD49 A 0 A_ChangeFlag("DropOff", 0)
			VD49 A 0 A_TakeInventory("MMRandomizer_WraithTeleporting", 1)
			VD49 F 5 A_FaceTarget
			VD49 G 0 A_PlayWeaponSound("VDR/D3Wraith/Attack")
			VD49 G 8 A_MeleeAttack
			Goto See
		Missile:
			VD49 A 0 A_JumpIfCloser(128, 2)
			VD49 A 0 A_JumpIfCloser(1024, 2)
			VD49 A 0
			Goto See
			VD49 A 0 A_Jump(128, "Teleport")
			Goto See
		Teleport:
			VD49 AAA 6 A_FaceTarget
			TNT1 A 0 A_GiveInventory("MMRandomizer_WraithTeleporting", 1)
			TNT1 A 0 A_SpawnItem("TeleportFog")
			TNT1 A 0 A_ChangeFlag("Invulnerable", 1)
			TNT1 A 0 A_ChangeFlag("NonShootable", 1)
			TNT1 A 0 A_ChangeFlag("NoTeleport", 1)
			TNT1 A 0 A_ChangeFlag("NoRadiusDMG", 1)
			TNT1 A 0 A_ChangeFlag("DropOff", 1)
			TNT1 A 0 A_UnSetShootable
			TNT1 AAAAAAAAAAAAAAAAAAAAAAAAA 0 A_ExtChase(1, 0, 0, 0)
			TNT1 AAAAAAAAAAAAAAAAAAAAAAAAA 0 A_ExtChase(1, 0, 0, 0)
			TNT1 A 1 A_ExtChase(1, 0, 0, 0)
			VD49 A 0 A_SpawnItem("TeleportFog")
			VD49 A 0 A_ChangeFlag("Invulnerable", 0)
			VD49 A 0 A_SetShootable
			VD49 A 0 A_ChangeFlag("NonShootable", 0)
			VD49 A 0 A_ChangeFlag("Shootable", 1)
			VD49 A 0 A_ChangeFlag("NoTeleport", 0)
			VD49 A 0 A_ChangeFlag("NoRadiusDMG", 0)
			VD49 A 0 A_ChangeFlag("DropOff", 0)
			VD49 A 0 A_TakeInventory("MMRandomizer_WraithTeleporting", 1)
			VD49 AA 6 A_FaceTarget
			Goto See
		Pain:
			VD49 A 4
			VD49 A 4 A_Pain
			Goto See
		Death:
			VD49 H 8
			VD49 I 8 A_Scream
			VD49 J 6
			VD49 K 6 A_NoBlocking
			VD49 L -1
			Stop
		Raise:
			VD49 LKJIH 8
			Goto See
	}
}

Actor MMRandomizer_WraithTeleporting : Inventory
{
	Inventory.MaxAmount 1
}
